# ç”¨æˆ·é—®é¢˜è§£ç­”ä¸æŠ€æœ¯è¯´æ˜

## 1. æ•°æ®åº“è¡¨æ•°é‡é”™è¯¯æ›´æ­£ âŒâ†’âœ…

### æˆ‘çš„é”™è¯¯
æŠ¥å‘Šä¸­å†™çš„ï¼š**11å¼ è¡¨** âŒ  
å®é™…å‡†ç¡®æ•°é‡ï¼š**15å¼ è¡¨** âœ…

### å‡†ç¡®çš„è¡¨æ¸…å•

| åºå· | è¡¨å | è¯´æ˜ | åˆ†ç±» |
|------|------|------|------|
| 1 | `categories` | å¯¼èˆªåˆ†ç±» | å¯¼èˆªç³»ç»Ÿ |
| 2 | `websites` | ç½‘ç«™ | å¯¼èˆªç³»ç»Ÿ |
| 3 | `article_categories` | æ–‡ç« åˆ†ç±» | æ–‡ç« ç³»ç»Ÿ |
| 4 | `articles` | æ–‡ç«  | æ–‡ç« ç³»ç»Ÿ |
| 5 | `tags` | æ ‡ç­¾ | æ ‡ç­¾ç³»ç»Ÿ |
| 6 | `website_tags` | ç½‘ç«™-æ ‡ç­¾å…³è” | æ ‡ç­¾ç³»ç»Ÿ |
| 7 | `article_tags` | æ–‡ç« -æ ‡ç­¾å…³è” | æ ‡ç­¾ç³»ç»Ÿ |
| 8 | `users` | ç”¨æˆ· | ç”¨æˆ·ç³»ç»Ÿ |
| 9 | `media_folders` | åª’ä½“æ–‡ä»¶å¤¹ | åª’ä½“åº“ |
| 10 | `media` | åª’ä½“æ–‡ä»¶ | åª’ä½“åº“ |
| 11 | `website_favorites` | ç½‘ç«™æ”¶è— | æ”¶è—ç³»ç»Ÿ |
| 12 | `article_favorites` | æ–‡ç« æ”¶è— | æ”¶è—ç³»ç»Ÿ |
| 13 | `floating_buttons` | æ‚¬æµ®æŒ‰é’® | å…¨å±€é…ç½® |
| 14 | `system_configs` | ç³»ç»Ÿé…ç½® | å…¨å±€é…ç½® |
| 15 | `navigation_menus` | å¯¼èˆªèœå• | å…¨å±€é…ç½® |

### ä¸ºä»€ä¹ˆæˆ‘æ•°é”™äº†ï¼Ÿ
æˆ‘åœ¨è¯„ä¼°æ—¶æ¼æ•°äº†4å¼ è¡¨ï¼š
- âŒ æ¼äº† `website_tags` å’Œ `article_tags`ï¼ˆå…³è”è¡¨ï¼‰
- âŒ æ¼äº† `floating_buttons` å’Œ `navigation_menus`

**éå¸¸æŠ±æ­‰ï¼æˆ‘ä¼šæ›´æ–°è¯„ä¼°æŠ¥å‘Šã€‚**

---

## 2. å•å…ƒæµ‹è¯•å’ŒE2Eæµ‹è¯•æ˜¯ä»€ä¹ˆï¼Ÿå¿…é¡»è¦æœ‰å—ï¼Ÿ

### ğŸ§ª å•å…ƒæµ‹è¯•ï¼ˆUnit Testï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ

**é€šä¿—è§£é‡Š**ï¼šç»™ä»£ç çš„æ¯ä¸ªå°åŠŸèƒ½å†™ä¸€ä¸ª"è‡ªåŠ¨åŒ–æ£€æŸ¥å‘˜"ã€‚

**ä¸¾ä¾‹è¯´æ˜**ï¼š
```typescript
// ä½ å†™çš„åŠŸèƒ½å‡½æ•°
function calculateTotal(price, quantity) {
  return price * quantity;
}

// å•å…ƒæµ‹è¯•ï¼ˆè‡ªåŠ¨æ£€æŸ¥è¿™ä¸ªå‡½æ•°æ˜¯å¦æ­£ç¡®ï¼‰
test('è®¡ç®—æ€»ä»·', () => {
  expect(calculateTotal(10, 5)).toBe(50);  // âœ… é€šè¿‡
  expect(calculateTotal(0, 5)).toBe(0);    // âœ… é€šè¿‡
  expect(calculateTotal(-10, 5)).toBe(-50); // âœ… é€šè¿‡
});
```

**æµ‹ä»€ä¹ˆï¼Ÿ**
- æµ‹è¯•å•ä¸ªå‡½æ•°ã€ç»„ä»¶ã€APIæ¥å£
- éªŒè¯è¾“å…¥è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸ
- è¾¹ç•Œæƒ…å†µæµ‹è¯•ï¼ˆç©ºå€¼ã€è´Ÿæ•°ã€è¶…å¤§æ•°ç­‰ï¼‰

---

### ğŸŒ E2Eæµ‹è¯•ï¼ˆEnd-to-End Testï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ

**é€šä¿—è§£é‡Š**ï¼šæ¨¡æ‹Ÿä¸€ä¸ªçœŸå®ç”¨æˆ·ï¼Œè‡ªåŠ¨æ“ä½œä½ çš„ç½‘ç«™ã€‚

**ä¸¾ä¾‹è¯´æ˜**ï¼š
```typescript
// E2Eæµ‹è¯•ï¼šæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•æµç¨‹
test('ç”¨æˆ·ç™»å½•', async () => {
  await page.goto('http://localhost:3000/login');
  await page.fill('input[name="username"]', 'admin');
  await page.fill('input[name="password"]', 'admin123');
  await page.click('button[type="submit"]');
  await expect(page).toHaveURL('/admin');  // âœ… è·³è½¬åˆ°åå°
});
```

**æµ‹ä»€ä¹ˆï¼Ÿ**
- æµ‹è¯•å®Œæ•´çš„ä¸šåŠ¡æµç¨‹
- ç”¨æˆ·ç™»å½• â†’ æ·»åŠ ç½‘ç«™ â†’ ä¿å­˜ â†’ å‰å°æ˜¾ç¤º
- æ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œï¼ˆç‚¹å‡»ã€è¾“å…¥ã€è·³è½¬ï¼‰

---

### ğŸ“Š å¿…é¡»è¦æœ‰å—ï¼Ÿæœ‰å¿…è¦å—ï¼Ÿ

#### âŒ ä¸æ˜¯å¿…é¡»çš„

**ä½ çš„é¡¹ç›®ç°åœ¨å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸æµ‹è¯•ä¹Ÿæ²¡å…³ç³»ã€‚**

#### âœ… ä½†éå¸¸å»ºè®®æœ‰

**åŸå› **ï¼š

1. **é˜²æ­¢æ”¹åä»£ç **
   ```
   åœºæ™¯ï¼šä½ ä¿®æ”¹äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œç»“æœä¸å°å¿ƒæŠŠå¦ä¸€ä¸ªåŠŸèƒ½æåäº†
   æœ‰æµ‹è¯•ï¼šâŒ æµ‹è¯•ç«‹åˆ»æŠ¥é”™ï¼Œä½ é©¬ä¸ŠçŸ¥é“å“ªé‡Œåäº†
   æ²¡æµ‹è¯•ï¼šğŸ˜± ç”¨æˆ·ç”¨äº†ä¸€å‘¨æ‰å‘ç°ï¼Œå·²ç»äº§ç”Ÿäº†å¤§é‡è„æ•°æ®
   ```

2. **èŠ‚çœæ—¶é—´**
   ```
   æ²¡æµ‹è¯•ï¼šæ¯æ¬¡æ”¹ä»£ç ï¼Œæ‰‹åŠ¨ç‚¹10åˆ†é’Ÿæµ‹è¯•åŠŸèƒ½
   æœ‰æµ‹è¯•ï¼šè¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œ30ç§’æµ‹å®Œæ‰€æœ‰åŠŸèƒ½
   ```

3. **é‡æ„æ›´è‡ªä¿¡**
   ```
   æ²¡æµ‹è¯•ï¼šä¸æ•¢å¤§æ”¹ä»£ç ï¼Œæ€•æ”¹å
   æœ‰æµ‹è¯•ï¼šæ”¾å¿ƒé‡æ„ï¼Œæµ‹è¯•ä¿è¯åŠŸèƒ½æ­£ç¡®
   ```

#### ğŸ¯ æˆ‘çš„å»ºè®®

**å¯¹äºä½ çš„é¡¹ç›®ï¼ˆä¸ªäººé¡¹ç›®/å°å›¢é˜Ÿï¼‰**ï¼š

âœ… **æ¨èä¼˜å…ˆçº§**ï¼š
1. **æš‚æ—¶ä¸ç”¨åš**ï¼ˆé¡¹ç›®å¯ç”¨å°±è¡Œï¼‰
2. **å¦‚æœé¡¹ç›®è¦ç»™å¾ˆå¤šäººç”¨**ï¼šå»ºè®®è‡³å°‘å†™æ ¸å¿ƒåŠŸèƒ½çš„æµ‹è¯•
3. **å¦‚æœå›¢é˜Ÿæœ‰å¤šäººåä½œ**ï¼šå¼ºçƒˆå»ºè®®å†™æµ‹è¯•

âŒ **ä¸å»ºè®®**ï¼š
- ä¸è¦ä¸€å¼€å§‹å°±è¿½æ±‚100%æµ‹è¯•è¦†ç›–ç‡
- æµ‹è¯•ä¼šèŠ±æ—¶é—´ï¼Œæƒè¡¡åˆ©å¼Š

---

## 3. APIé™æµæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

### ğŸš¦ APIé™æµï¼ˆRate Limitingï¼‰

**é€šä¿—è§£é‡Š**ï¼šç»™ä½ çš„APIæ¥å£è®¾ç½®"ä½¿ç”¨æ¬¡æ•°ä¸Šé™"ï¼Œé˜²æ­¢è¢«æ»¥ç”¨ã€‚

### ä¸¾ä¾‹è¯´æ˜

#### âŒ æ²¡æœ‰é™æµçš„é—®é¢˜

**åœºæ™¯1ï¼šæ¶æ„æ”»å‡»**
```
é»‘å®¢å†™ä¸ªè„šæœ¬ï¼š
æ¯ç§’è°ƒç”¨ä½ çš„ç™»å½•API 1000æ¬¡
â†“
ä½ çš„æœåŠ¡å™¨ï¼šğŸ’¥ ç‚¸äº†ï¼ˆCPU 100%ï¼Œå†…å­˜çˆ†æ»¡ï¼‰
â†“
æ­£å¸¸ç”¨æˆ·ï¼šğŸ˜± ç½‘ç«™æ‰“ä¸å¼€äº†
```

**åœºæ™¯2ï¼šæš´åŠ›ç ´è§£å¯†ç **
```
é»‘å®¢ï¼šè¿ç»­å°è¯•10ä¸‡ä¸ªå¯†ç ç»„åˆ
â†“
æ²¡æœ‰é™æµï¼šå…¨éƒ¨å°è¯•æˆåŠŸï¼Œå¯èƒ½çœŸçš„ç ´è§£äº†å¯†ç 
æœ‰é™æµï¼šåªèƒ½å°è¯•5æ¬¡ï¼Œç„¶åå°IP/è´¦å·
```

**åœºæ™¯3ï¼šçˆ¬è™«æŠ“æ•°æ®**
```
ç«äº‰å¯¹æ‰‹ï¼šå†™çˆ¬è™«ç–¯ç‹‚æŠ“ä½ çš„ç½‘ç«™æ•°æ®
â†“
æ²¡æœ‰é™æµï¼šæŠŠä½ çš„æ•°æ®åº“å…¨æŠ“èµ°äº†
æœ‰é™æµï¼šæ¯å°æ—¶æœ€å¤š100æ¬¡è¯·æ±‚ï¼ŒæŠ“ä¸äº†å¤šå°‘
```

---

### âœ… æœ‰äº†é™æµçš„ä¿æŠ¤

```typescript
// ç™»å½•æ¥å£é™æµç¤ºä¾‹
const loginLimiter = {
  windowMs: 15 * 60 * 1000,  // 15åˆ†é’Ÿå†…
  max: 5,                     // æœ€å¤š5æ¬¡å°è¯•
  message: 'ç™»å½•å¤±è´¥æ¬¡æ•°è¿‡å¤šï¼Œè¯·15åˆ†é’Ÿåå†è¯•'
};

// ç”¨æˆ·å°è¯•ç¬¬6æ¬¡ç™»å½•
â†’ âŒ ç›´æ¥æ‹’ç»ï¼Œè¿”å› 429 Too Many Requests
```

---

### ğŸ¯ ä½ çš„é¡¹ç›®éœ€è¦é™æµå—ï¼Ÿ

#### âœ… **å»ºè®®è‡³å°‘å¯¹è¿™äº›æ¥å£é™æµ**ï¼š

| æ¥å£ | é™åˆ¶ | åŸå›  |
|------|------|------|
| `/api/auth/login` | 15åˆ†é’Ÿ5æ¬¡ | é˜²æ­¢æš´åŠ›ç ´è§£å¯†ç  |
| `/api/search` | 1åˆ†é’Ÿ10æ¬¡ | æœç´¢å¾ˆæ¶ˆè€—èµ„æº |
| `/api/admin/*`ï¼ˆæ‰€æœ‰ç®¡ç†æ¥å£ï¼‰ | 1åˆ†é’Ÿ60æ¬¡ | é˜²æ­¢æ‰¹é‡æ“ä½œæ”»å‡» |

#### ğŸ“ å®ç°å¾ˆç®€å•

```bash
npm install express-rate-limit
```

```typescript
// åœ¨APIè·¯ç”±ä¸­æ·»åŠ å‡ è¡Œä»£ç å³å¯
import rateLimit from 'express-rate-limit';

const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 5,
  message: 'ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•'
});

export async function POST(request: Request) {
  // åº”ç”¨é™æµ
  await loginLimiter(request);
  
  // åŸæœ‰çš„ç™»å½•é€»è¾‘
  // ...
}
```

---

## 4. next/image + éª¨æ¶å±ä¼˜åŒ–

### âœ… ä½ çš„è¦æ±‚æˆ‘å®Œå…¨ç†è§£ï¼

ä½ è¦çš„æ˜¯ï¼š
1. **éª¨æ¶å±è¦ç²¾ç¡®åŒ¹é…å®é™…å¸ƒå±€**ï¼ˆä¸èƒ½8ä¸ªå˜12ä¸ªï¼Œå¤§å°å½¢çŠ¶è¦ä¸€è‡´ï¼‰
2. **é¦–æ¬¡åŠ è½½æ˜¾ç¤ºéª¨æ¶å±**ï¼ˆè®©ç”¨æˆ·çŸ¥é“å†…å®¹æ­£åœ¨åŠ è½½ï¼‰
3. **åç»­ä¸è¦é¢‘ç¹æ˜¾ç¤ºéª¨æ¶å±**ï¼ˆåˆ©ç”¨ç¼“å­˜ï¼Œä½“éªŒæ›´æµç•…ï¼‰

---

### ğŸ¨ ç²¾ç¡®éª¨æ¶å±å®ç°æ–¹æ¡ˆ

#### é—®é¢˜æ ¹æºåˆ†æ

**å½“å‰é—®é¢˜**ï¼š
```typescript
// éª¨æ¶å±å†™æ­»äº†12ä¸ª
{[...Array(12)].map((_, i) => <WebsiteCardSkeleton key={i} />)}

// ä½†å®é™…æ•°æ®åªæœ‰8ä¸ª
websites.map(site => <WebsiteCard {...site} />)

// ç»“æœï¼šéª¨æ¶å±å’Œå®é™…ä¸åŒ¹é… âŒ
```

#### âœ… æ­£ç¡®åšæ³•

**æ–¹æ¡ˆ1ï¼šæ ¹æ®å®é™…æ•°æ®æ•°é‡æ¸²æŸ“éª¨æ¶å±**

```typescript
// src/app/page.tsx
const [websites, setWebsites] = useState([]);
const [loading, setLoading] = useState(true);

// é¦–æ¬¡åŠ è½½
useEffect(() => {
  fetchWebsites().then(data => {
    setWebsites(data);
    setLoading(false);
  });
}, []);

// æ¸²æŸ“
{loading ? (
  // æ ¹æ®å®é™…æ•°æ®æ¸²æŸ“å¯¹åº”æ•°é‡çš„éª¨æ¶å±
  <div className="grid grid-cols-6 gap-4">
    {[...Array(category.websiteCount || 6)].map((_, i) => (
      <WebsiteCardSkeleton key={i} size={category.displayMode} />
    ))}
  </div>
) : (
  <div className="grid grid-cols-6 gap-4">
    {websites.map(site => (
      <WebsiteCard key={site.id} {...site} />
    ))}
  </div>
)}
```

**æ–¹æ¡ˆ2ï¼šæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰+ å®¢æˆ·ç«¯ç¼“å­˜**

```typescript
// src/app/page.tsx
// ä½¿ç”¨Next.jsçš„æœåŠ¡ç«¯æ¸²æŸ“
export default async function HomePage() {
  // æœåŠ¡ç«¯ç›´æ¥è·å–æ•°æ®ï¼Œé¦–å±æ— éœ€éª¨æ¶å±
  const websites = await getWebsites();
  
  return (
    <div className="grid grid-cols-6 gap-4">
      {websites.map(site => (
        <WebsiteCard key={site.id} {...site} />
      ))}
    </div>
  );
}
```

---

### ğŸ’¾ ç¼“å­˜ç­–ç•¥ï¼šåç»­ä¸æ˜¾ç¤ºéª¨æ¶å±

#### âœ… æ–¹æ¡ˆ1ï¼šSWRï¼ˆæ¨èï¼‰

**å®‰è£…**ï¼š
```bash
npm install swr
```

**ä½¿ç”¨**ï¼š
```typescript
import useSWR from 'swr';

function HomePage() {
  const { data: websites, isLoading } = useSWR('/api/websites', {
    revalidateOnFocus: false,  // åˆ‡æ¢çª—å£ä¸é‡æ–°åŠ è½½
    revalidateOnReconnect: false,  // é‡è¿ä¸é‡æ–°åŠ è½½
    dedupingInterval: 60000,  // 60ç§’å†…é‡å¤è¯·æ±‚ä½¿ç”¨ç¼“å­˜
  });

  // åªæœ‰é¦–æ¬¡åŠ è½½ä¸”æ— ç¼“å­˜æ—¶æ˜¾ç¤ºéª¨æ¶å±
  if (isLoading && !websites) {
    return <WebsiteCardSkeleton />;
  }

  // æœ‰ç¼“å­˜æ—¶ç›´æ¥æ˜¾ç¤ºï¼Œä¸æ˜¾ç¤ºéª¨æ¶å±
  return <WebsiteCard data={websites} />;
}
```

**æ•ˆæœ**ï¼š
- âœ… é¦–æ¬¡è®¿é—®ï¼šæ˜¾ç¤ºéª¨æ¶å±ï¼ˆ2ç§’ï¼‰â†’ æ˜¾ç¤ºå†…å®¹
- âœ… åˆ·æ–°é¡µé¢ï¼šç›´æ¥æ˜¾ç¤ºç¼“å­˜å†…å®¹ï¼ˆæ— éª¨æ¶å±ï¼‰
- âœ… åˆ‡æ¢é¡µé¢å›æ¥ï¼šç›´æ¥æ˜¾ç¤ºç¼“å­˜å†…å®¹ï¼ˆæ— éª¨æ¶å±ï¼‰

---

#### âœ… æ–¹æ¡ˆ2ï¼šNext.js App Routerç¼“å­˜

```typescript
// src/app/page.tsx
import { cache } from 'react';

// æ•°æ®ç¼“å­˜60ç§’
export const revalidate = 60;

export default async function HomePage() {
  const websites = await fetch('/api/websites', {
    next: { revalidate: 60 }  // 60ç§’å†…ä½¿ç”¨ç¼“å­˜
  }).then(res => res.json());

  // æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ— éª¨æ¶å±
  return <WebsiteCard data={websites} />;
}
```

---

### ğŸ–¼ï¸ next/imageä¼˜åŒ–

#### å½“å‰é—®é¢˜

```tsx
// âŒ å½“å‰ï¼šä½¿ç”¨<img>æ ‡ç­¾
<img src={logoUrl} alt={name} className="w-12 h-12" />
```

**é—®é¢˜**ï¼š
- ä¸ä¼šè‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡
- ä¸ä¼šæ‡’åŠ è½½
- ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆå“åº”å¼å›¾ç‰‡

#### âœ… æ”¹ç”¨next/image

```tsx
import Image from 'next/image';

// âœ… ä¼˜åŒ–å
<Image 
  src={logoUrl} 
  alt={name}
  width={48}
  height={48}
  loading="lazy"  // æ‡’åŠ è½½
  placeholder="blur"  // æ¨¡ç³Šå ä½ç¬¦
  blurDataURL="/placeholder.jpg"  // å ä½å›¾
  className="w-12 h-12"
/>
```

**ä¼˜åŠ¿**ï¼š
- âœ… è‡ªåŠ¨æ‡’åŠ è½½ï¼ˆä¸åœ¨è§†é‡å†…çš„å›¾ç‰‡ä¸åŠ è½½ï¼‰
- âœ… è‡ªåŠ¨ä¼˜åŒ–æ ¼å¼ï¼ˆWebP, AVIFï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆä¸åŒå°ºå¯¸ï¼ˆå“åº”å¼ï¼‰
- âœ… é˜²æ­¢å¸ƒå±€åç§»ï¼ˆCLSä¼˜åŒ–ï¼‰

---

### ğŸ¯ éª¨æ¶å±çš„æœ€ä½³å®è·µ

```typescript
// âœ… ç²¾ç¡®éª¨æ¶å±ç»„ä»¶
function WebsiteCardSkeleton({ size = 'medium' }) {
  const sizeClasses = {
    small: 'w-20 h-20',
    medium: 'w-24 h-24',
    large: 'w-32 h-32'
  };

  return (
    <div className="bg-white rounded-lg p-4 animate-pulse">
      {/* Logoéª¨æ¶ï¼šç²¾ç¡®åŒ¹é…å®é™…å¤§å° */}
      <div className={`${sizeClasses[size]} bg-gray-200 rounded-lg mb-3`} />
      
      {/* æ ‡é¢˜éª¨æ¶ */}
      <div className="h-5 bg-gray-200 rounded w-3/4 mb-2" />
      
      {/* æè¿°éª¨æ¶ */}
      <div className="h-4 bg-gray-200 rounded w-full mb-1" />
      <div className="h-4 bg-gray-200 rounded w-2/3" />
    </div>
  );
}

// âœ… ä½¿ç”¨æ—¶ä¼ å…¥å®é™…é…ç½®
<WebsiteCardSkeleton size={category.displayMode} />
```

---

## 5. æ“ä½œæ—¥å¿—å’Œç›‘æ§

### âœ… æ˜¯çš„ï¼Œå†™åœ¨ç®¡ç†åå°

### ğŸ“‹ æ“ä½œæ—¥å¿—ï¼ˆAudit Logï¼‰

**åŠŸèƒ½**ï¼šè®°å½•ç®¡ç†å‘˜çš„æ‰€æœ‰æ“ä½œ

**æ•°æ®åº“è¡¨**ï¼š
```prisma
model AuditLog {
  id         Int      @id @default(autoincrement())
  userId     Int      // æ“ä½œäºº
  action     String   // æ“ä½œç±»å‹ï¼šCREATE, UPDATE, DELETE
  module     String   // æ¨¡å—ï¼šWebsite, Article, User
  targetId   Int      // æ“ä½œå¯¹è±¡ID
  changes    Json?    // ä¿®æ”¹å†…å®¹ï¼ˆå‰åå¯¹æ¯”ï¼‰
  ip         String?  // IPåœ°å€
  userAgent  String?  // æµè§ˆå™¨ä¿¡æ¯
  createdAt  DateTime @default(now())

  user User @relation(fields: [userId], references: [id])

  @@map("audit_logs")
  @@index([userId])
  @@index([module])
  @@index([createdAt])
}
```

**åå°ç®¡ç†é¡µé¢**ï¼š`/admin/logs`

```tsx
// æ“ä½œæ—¥å¿—åˆ—è¡¨
function AuditLogsPage() {
  const [logs, setLogs] = useState([]);

  return (
    <AdminLayout>
      <h1>æ“ä½œæ—¥å¿—</h1>
      <table>
        <thead>
          <tr>
            <th>æ—¶é—´</th>
            <th>æ“ä½œäºº</th>
            <th>æ“ä½œç±»å‹</th>
            <th>æ¨¡å—</th>
            <th>è¯¦æƒ…</th>
          </tr>
        </thead>
        <tbody>
          {logs.map(log => (
            <tr key={log.id}>
              <td>{log.createdAt}</td>
              <td>{log.user.username}</td>
              <td>
                <span className={log.action === 'DELETE' ? 'text-red-600' : ''}>
                  {log.action}
                </span>
              </td>
              <td>{log.module}</td>
              <td>
                <button onClick={() => viewDetails(log)}>
                  æŸ¥çœ‹è¯¦æƒ…
                </button>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </AdminLayout>
  );
}
```

---

### ğŸ“Š ç³»ç»Ÿç›‘æ§

**åå°ç®¡ç†é¡µé¢**ï¼š`/admin/dashboard`

**ç›‘æ§å†…å®¹**ï¼š

1. **æ•°æ®ç»Ÿè®¡**
   - ç½‘ç«™æ€»æ•°ã€æ–‡ç« æ€»æ•°ã€ç”¨æˆ·æ€»æ•°
   - ä»Šæ—¥æ–°å¢ã€æœ¬å‘¨æ–°å¢ã€æœ¬æœˆæ–°å¢
   - çƒ­é—¨ç½‘ç«™æ’è¡Œï¼ˆç‚¹å‡»é‡Top 10ï¼‰
   - çƒ­é—¨æ–‡ç« æ’è¡Œï¼ˆæµè§ˆé‡Top 10ï¼‰

2. **è®¿é—®ç»Ÿè®¡**
   - ä»Šæ—¥è®¿é—®é‡ã€æœ¬å‘¨è®¿é—®é‡
   - è®¿é—®æ¥æºï¼ˆç›´æ¥è®¿é—®ã€æœç´¢å¼•æ“ã€å¤–é“¾ï¼‰
   - æµè§ˆå™¨åˆ†å¸ƒã€è®¾å¤‡åˆ†å¸ƒ

3. **ç³»ç»ŸçŠ¶æ€**
   - æ•°æ®åº“è¿æ¥çŠ¶æ€
   - COSå­˜å‚¨ä½¿ç”¨é‡
   - æœåŠ¡å™¨èµ„æºä½¿ç”¨ï¼ˆCPUã€å†…å­˜ï¼‰

```tsx
// ç›‘æ§ä»ªè¡¨ç›˜
function DashboardPage() {
  const [stats, setStats] = useState({
    websiteCount: 0,
    articleCount: 0,
    userCount: 0,
    todayViews: 0,
  });

  return (
    <AdminLayout>
      <div className="grid grid-cols-4 gap-6">
        {/* ç»Ÿè®¡å¡ç‰‡ */}
        <StatCard
          title="ç½‘ç«™æ€»æ•°"
          value={stats.websiteCount}
          icon="ğŸŒ"
          trend="+12"
        />
        <StatCard
          title="æ–‡ç« æ€»æ•°"
          value={stats.articleCount}
          icon="ğŸ“"
          trend="+5"
        />
        <StatCard
          title="ç”¨æˆ·æ€»æ•°"
          value={stats.userCount}
          icon="ğŸ‘¥"
          trend="+2"
        />
        <StatCard
          title="ä»Šæ—¥è®¿é—®"
          value={stats.todayViews}
          icon="ğŸ“Š"
          trend="+128"
        />
      </div>

      {/* å›¾è¡¨ */}
      <div className="mt-6 grid grid-cols-2 gap-6">
        <ChartCard title="è®¿é—®é‡è¶‹åŠ¿">
          <LineChart data={viewsData} />
        </ChartCard>
        <ChartCard title="çƒ­é—¨å†…å®¹">
          <BarChart data={popularData} />
        </ChartCard>
      </div>
    </AdminLayout>
  );
}
```

---

## ğŸ¯ æ€»ç»“

| é—®é¢˜ | å›ç­” |
|------|------|
| 1. æ•°æ®åº“è¡¨æ•°é‡ | âœ… **15å¼ è¡¨**ï¼ˆæˆ‘ä¹‹å‰æ•°é”™äº†ï¼ŒæŠ±æ­‰ï¼‰ |
| 2. å•å…ƒæµ‹è¯•/E2Eæµ‹è¯• | âš ï¸ **ä¸æ˜¯å¿…é¡»çš„**ï¼Œä½†å»ºè®®æ ¸å¿ƒåŠŸèƒ½æœ‰æµ‹è¯• |
| 3. APIé™æµ | âœ… **å»ºè®®å®ç°**ï¼Œé˜²æ­¢æ¶æ„æ”»å‡»å’Œæ»¥ç”¨ |
| 4. éª¨æ¶å± | âœ… **ç²¾ç¡®åŒ¹é…å®é™…å¸ƒå±€ + ç¼“å­˜ç­–ç•¥** |
| 5. æ“ä½œæ—¥å¿—/ç›‘æ§ | âœ… **åœ¨ç®¡ç†åå°å®ç°**ï¼Œ`/admin/logs` å’Œ `/admin/dashboard` |

---

**æ¥ä¸‹æ¥éœ€è¦æˆ‘åšä»€ä¹ˆï¼Ÿ**

1. âœ… æ›´æ–°è¯„ä¼°æŠ¥å‘Šï¼ˆæ”¹æ­£15å¼ è¡¨ï¼‰
2. âœ… å®ç°ç²¾ç¡®éª¨æ¶å±
3. âœ… å®ç°ç¼“å­˜ç­–ç•¥ï¼ˆSWRæˆ–Next.jsç¼“å­˜ï¼‰
4. âœ… æ›¿æ¢<img>ä¸ºnext/image
5. âœ… å®ç°æ“ä½œæ—¥å¿—åŠŸèƒ½
6. âœ… å®ç°ç›‘æ§ä»ªè¡¨ç›˜
7. âš ï¸ APIé™æµï¼ˆå¯é€‰ï¼‰
8. âš ï¸ å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰

**ä½ æƒ³å…ˆä»å“ªä¸ªå¼€å§‹ï¼Ÿ**


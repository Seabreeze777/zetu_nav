# ğŸš€ é¡¹ç›®éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£æä¾›è¯¦ç»†çš„é¡¹ç›®éƒ¨ç½²æ­¥éª¤å’Œæ³¨æ„äº‹é¡¹ã€‚

---

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### å¿…éœ€ç¯å¢ƒ
- [x] Node.js 18+ 
- [x] MySQL 8.0+
- [x] npm æˆ– yarn

### å¿…éœ€é…ç½®
- [x] æ•°æ®åº“è¿æ¥ä¿¡æ¯
- [ ] è…¾è®¯äº‘COSé…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºå›¾ç‰‡ä¸Šä¼ ï¼‰
- [x] JWTå¯†é’¥

---

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

### 1. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL="mysql://ç”¨æˆ·å:å¯†ç @æ•°æ®åº“åœ°å€:ç«¯å£/æ•°æ®åº“å"

# JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²ï¼‰
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"

# è…¾è®¯äº‘COSé…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºå›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼‰
TENCENT_SECRET_ID="your-secret-id"
TENCENT_SECRET_KEY="your-secret-key"
COS_BUCKET="your-bucket-name"
COS_REGION="ap-chengdu"
```

### 2. ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡å | è¯´æ˜ | å¿…éœ€ | ç¤ºä¾‹ |
|--------|------|------|------|
| `DATABASE_URL` | MySQLæ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | âœ… | `mysql://zetu-nav:password@localhost:3306/zetu-nav` |
| `JWT_SECRET` | JWT tokenåŠ å¯†å¯†é’¥ | âœ… | `my-super-secret-jwt-key-123456` |
| `TENCENT_SECRET_ID` | è…¾è®¯äº‘APIå¯†é’¥ID | âŒ | `AKIDxxxxxxxx` |
| `TENCENT_SECRET_KEY` | è…¾è®¯äº‘APIå¯†é’¥Key | âŒ | `xxxxxxxx` |
| `COS_BUCKET` | COSå­˜å‚¨æ¡¶åç§° | âŒ | `zetu-nav-1302966033` |
| `COS_REGION` | COSåŒºåŸŸ | âŒ | `ap-chengdu` |

> **âš ï¸ å®‰å…¨æç¤ºï¼š**
> - `.env` æ–‡ä»¶ä¸è¦æäº¤åˆ°Gitä»“åº“
> - ç”Ÿäº§ç¯å¢ƒçš„ `JWT_SECRET` å¿…é¡»ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²
> - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ä»»ä½•å¯†é’¥

---

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ npm
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

---

## ğŸ—„ï¸ åˆå§‹åŒ–æ•°æ®åº“

### 1. åŒæ­¥æ•°æ®åº“ç»“æ„

```bash
npx prisma db push
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
- åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„æ•°æ®è¡¨
- æ ¹æ® `prisma/schema.prisma` åŒæ­¥æ•°æ®åº“ç»“æ„
- ä¸ä¼šåˆ é™¤å·²æœ‰æ•°æ®

### 2. å¡«å……åˆå§‹æ•°æ®ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ˜¯å…¨æ–°æ•°æ®åº“ï¼Œå¯ä»¥è¿è¡Œç§å­è„šæœ¬ï¼š

```bash
npm run seed
```

è¿™ä¼šåˆ›å»ºï¼š
- é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆ`admin` / `admin123`ï¼‰
- ç¤ºä¾‹åˆ†ç±»
- ç¤ºä¾‹ç½‘ç«™
- ç¤ºä¾‹æ–‡ç« 

> **âš ï¸ æ³¨æ„ï¼š** ç§å­è„šæœ¬ä¼šæ¸…ç©ºç°æœ‰æ•°æ®ï¼ä»…åœ¨é¦–æ¬¡éƒ¨ç½²æ—¶ä½¿ç”¨ã€‚

### 3. ä½¿ç”¨Prisma StudioæŸ¥çœ‹æ•°æ®ï¼ˆå¯é€‰ï¼‰

```bash
npx prisma studio
```

è¿™ä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢ã€‚

---

## ğŸ—ï¸ æ„å»ºé¡¹ç›®

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è®¿é—®ï¼š`http://localhost:3000`

### ç”Ÿäº§æ„å»º

```bash
# 1. æ„å»ºé¡¹ç›®
npm run build

# 2. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start
```

---

## ğŸŒ éƒ¨ç½²æ–¹å¼

### æ–¹æ¡ˆ1ï¼šVercelï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

1. å°†é¡¹ç›®æ¨é€åˆ°GitHub
2. åœ¨ [Vercel](https://vercel.com) å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆåœ¨Vercelæ§åˆ¶å°ï¼‰
4. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

> **æ³¨æ„ï¼š** Verceléœ€è¦ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆå¦‚PlanetScaleã€Railwayç­‰ï¼‰

### æ–¹æ¡ˆ2ï¼šä¼ ç»ŸæœåŠ¡å™¨ï¼ˆVPS/äº‘æœåŠ¡å™¨ï¼‰

#### ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹

1. **å®‰è£…PM2**
```bash
npm install -g pm2
```

2. **æ„å»ºé¡¹ç›®**
```bash
npm run build
```

3. **å¯åŠ¨æœåŠ¡**
```bash
pm2 start npm --name "zetu-nav" -- start
```

4. **å¸¸ç”¨PM2å‘½ä»¤**
```bash
# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs zetu-nav

# é‡å¯æœåŠ¡
pm2 restart zetu-nav

# åœæ­¢æœåŠ¡
pm2 stop zetu-nav

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

#### ä½¿ç”¨Nginxåå‘ä»£ç†

åˆ›å»ºNginxé…ç½®æ–‡ä»¶ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

### æ–¹æ¡ˆ3ï¼šDockerå®¹å™¨åŒ–

åˆ›å»º `Dockerfile`ï¼š

```dockerfile
FROM node:18-alpine

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
COPY prisma ./prisma/

# å®‰è£…ä¾èµ–
RUN npm ci

# å¤åˆ¶æºä»£ç 
COPY . .

# ç”ŸæˆPrisma Client
RUN npx prisma generate

# æ„å»ºé¡¹ç›®
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=mysql://user:password@db:3306/zetu-nav
      - JWT_SECRET=your-secret-key
    depends_on:
      - db

  db:
    image: mysql:8.0
    environment:
      - MYSQL_DATABASE=zetu-nav
      - MYSQL_USER=user
      - MYSQL_PASSWORD=password
      - MYSQL_ROOT_PASSWORD=rootpassword
    ports:
      - "3306:3306"
    volumes:
      - mysql-data:/var/lib/mysql

volumes:
  mysql-data:
```

è¿è¡Œï¼š

```bash
docker-compose up -d
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. æ•°æ®åº“å®‰å…¨
- âœ… ä½¿ç”¨å¼ºå¯†ç 
- âœ… é™åˆ¶æ•°æ®åº“è®¿é—®IP
- âœ… å®šæœŸå¤‡ä»½æ•°æ®
- âœ… ä½¿ç”¨SSLè¿æ¥ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

### 2. åº”ç”¨å®‰å…¨
- âœ… ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- âœ… ä½¿ç”¨HTTPSï¼ˆé…ç½®SSLè¯ä¹¦ï¼‰
- âœ… è®¾ç½®å¼ºJWTå¯†é’¥
- âœ… å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- âœ… å¯ç”¨CORSé™åˆ¶ï¼ˆå¦‚éœ€è¦ï¼‰

### 3. æ–‡ä»¶å®‰å…¨
- âœ… ä¸è¦å°† `.env` æäº¤åˆ°Git
- âœ… è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- âœ… å®šæœŸå®¡æŸ¥æ—¥å¿—

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®åº“ä¼˜åŒ–
```bash
# æ·»åŠ ç´¢å¼•ï¼ˆå·²åœ¨schemaä¸­å®šä¹‰ï¼‰
# å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
# ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± 
```

### 2. ç¼“å­˜ç­–ç•¥
- ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº
- å¯ç”¨æµè§ˆå™¨ç¼“å­˜

### 3. ä»£ç ä¼˜åŒ–
- ä½¿ç”¨å›¾ç‰‡æ‡’åŠ è½½
- ä»£ç åˆ†å‰²ï¼ˆNext.jså·²è‡ªåŠ¨å¤„ç†ï¼‰
- å‹ç¼©å›¾ç‰‡èµ„æº

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥ï¼š**
- æ•°æ®åº“æœåŠ¡æ˜¯å¦å¯åŠ¨
- è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®
- é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç«¯å£
- æ•°æ®åº“ç”¨æˆ·æƒé™æ˜¯å¦è¶³å¤Ÿ

### Q2: æ„å»ºå¤±è´¥

**è§£å†³ï¼š**
```bash
# æ¸…ç†ç¼“å­˜
rm -rf .next node_modules
npm install
npm run build
```

### Q3: Prismaç”Ÿæˆå¤±è´¥

**è§£å†³ï¼š**
```bash
npx prisma generate --force
```

### Q4: ç«¯å£è¢«å ç”¨

**è§£å†³ï¼š**
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :3000  # Windows
lsof -i :3000                 # Linux/Mac

# æ€æ­»è¿›ç¨‹æˆ–æ›´æ¢ç«¯å£
# åœ¨ package.json ä¸­ä¿®æ”¹å¯åŠ¨å‘½ä»¤
"dev": "next dev -p 3001"
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°å…¶ä»–é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é¡¹ç›®æ–‡æ¡£ï¼š`/docs` ç›®å½•
2. APIæ–‡æ¡£ï¼š`/docs/APIæ–‡æ¡£.md`
3. æ•°æ®åº“è®¾ç½®ï¼š`/DATABASE_SETUP.md`

---

## ğŸ¯ éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·é€é¡¹æ£€æŸ¥ï¼š

- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] å‰å°é¡µé¢å¯ä»¥è®¿é—®
- [ ] åå°å¯ä»¥ç™»å½•
- [ ] æ–‡ç« åˆ—è¡¨æ­£å¸¸æ˜¾ç¤º
- [ ] ç½‘ç«™å¯¼èˆªæ­£å¸¸æ˜¾ç¤º
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æ”¶è—åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] å›¾ç‰‡å¯ä»¥æ­£å¸¸åŠ è½½
- [ ] ä¿®æ”¹äº†é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- [ ] é…ç½®äº†SSLè¯ä¹¦ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰


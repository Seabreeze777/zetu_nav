# âœ… Next.js è·¯ç”±å†²çªå·²ä¿®å¤

## é—®é¢˜åŸå› 

Next.js **ä¸å…è®¸**åœ¨åŒä¸€ç›®å½•å±‚çº§ä½¿ç”¨ä¸åŒåç§°çš„åŠ¨æ€è·¯ç”±å‚æ•°ã€‚

**åŸé”™è¯¯ï¼š**
```
Error: You cannot use different slug names for the same dynamic path ('id' !== 'slug').
```

**å†²çªè·¯ç”±ï¼š**
```
src/app/api/articles/[id]/       âŒ ä¸ [slug] å†²çª
src/app/api/articles/[slug]/     âœ… ä¿ç•™
```

---

## è§£å†³æ–¹æ¡ˆ

### 1. åˆ é™¤å†²çªè·¯ç”±
åˆ é™¤äº† `src/app/api/articles/[id]/` ç›®å½•ï¼ˆåŒ…å« favorite ç›¸å…³APIï¼‰

### 2. åˆ›å»ºç‹¬ç«‹ API è·¯ç”±
åˆ›å»ºäº†æ–°çš„æ”¶è—APIè·¯ç”±ï¼š
```
src/app/api/favorites/[articleId]/route.ts
```

### 3. æ›´æ–°APIè°ƒç”¨
ä¿®æ”¹äº† `ArticleActions.tsx` ä¸­çš„APIè·¯å¾„ï¼š

**ä¿®æ”¹å‰ï¼š**
```typescript
fetch(`/api/articles/${articleId}/favorite/status`)  âŒ
fetch(`/api/articles/${articleId}/favorite`)         âŒ
```

**ä¿®æ”¹åï¼š**
```typescript
fetch(`/api/favorites/${articleId}`)  âœ…
```

### 4. æ¸…ç†ç¼“å­˜
```bash
Remove-Item -Path ".next" -Recurse -Force
```

---

## API è·¯ç”±è¯´æ˜

### æ”¶è—åŠŸèƒ½ API

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| `GET` | `/api/favorites/[articleId]` | æ£€æŸ¥æ”¶è—çŠ¶æ€ |
| `POST` | `/api/favorites/[articleId]` | æ”¶è—æ–‡ç«  |
| `DELETE` | `/api/favorites/[articleId]` | å–æ¶ˆæ”¶è— |

### è¿”å›æ ¼å¼

**æ£€æŸ¥çŠ¶æ€ (GET)ï¼š**
```json
{
  "success": true,
  "data": {
    "isFavorited": false
  }
}
```

**æ”¶è—æˆåŠŸ (POST)ï¼š**
```json
{
  "success": true,
  "message": "æ”¶è—æˆåŠŸ"
}
```

**å–æ¶ˆæ”¶è— (DELETE)ï¼š**
```json
{
  "success": true,
  "message": "å–æ¶ˆæ”¶è—æˆåŠŸ"
}
```

**é”™è¯¯å“åº”ï¼š**
```json
{
  "success": false,
  "error": "è¯·å…ˆç™»å½•"  // 401
}
```

---

## ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `src/app/api/articles/[id]/` | âŒ åˆ é™¤ | è·¯ç”±å†²çª |
| `src/app/api/favorites/[articleId]/route.ts` | âœ… åˆ›å»º | æ–°çš„æ”¶è—API |
| `src/components/article/ArticleActions.tsx` | âœ… ä¿®æ”¹ | æ›´æ–°APIè·¯å¾„ |
| `.next/` | âœ… æ¸…ç† | æ¸…é™¤ç¼“å­˜ |

---

## ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼

### å¯åŠ¨æœåŠ¡å™¨
```bash
npm run dev
```

### æµ‹è¯•æ”¶è—åŠŸèƒ½
1. è®¿é—®ä»»æ„æ–‡ç« è¯¦æƒ…é¡µ
2. ç‚¹å‡»"æ”¶è—"æŒ‰é’®
3. âœ… åº”è¯¥æ­£å¸¸å·¥ä½œï¼

**å¦‚æœæœªç™»å½•ï¼š**
- æç¤º"è¯·å…ˆç™»å½•"
- è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

**å¦‚æœå·²ç™»å½•ï¼š**
- æ”¶è—æˆåŠŸï¼šæŒ‰é’®å˜ä¸ºçº¢è‰²"å·²æ”¶è—"
- å†æ¬¡ç‚¹å‡»ï¼šå–æ¶ˆæ”¶è—ï¼ŒæŒ‰é’®å˜å›ç°è‰²"æ”¶è—"

---

## Next.js åŠ¨æ€è·¯ç”±è§„åˆ™

### âœ… å…è®¸ï¼ˆä¸åŒå±‚çº§ï¼‰ï¼š
```
/api/articles/[slug]/
/api/favorites/[id]/
/api/websites/[websiteId]/
```

### âŒ ä¸å…è®¸ï¼ˆåŒä¸€å±‚çº§ï¼‰ï¼š
```
/api/articles/[id]/      âŒ
/api/articles/[slug]/    âŒ
// åŒä¸€ç›®å½•ä¸‹ä¸èƒ½æœ‰ä¸åŒåç§°çš„åŠ¨æ€å‚æ•°
```

### âœ… å…è®¸ï¼ˆåŒåå‚æ•°ï¼‰ï¼š
```
/api/articles/[id]/
/api/articles/[id]/favorite/
/api/articles/[id]/view/
// å¯ä»¥æœ‰å­è·¯ç”±
```

---

## é‡è¦æç¤º

**è·¯ç”±å†²çªä¿®å¤åï¼Œå¿…é¡»ï¼š**
1. âœ… åˆ é™¤å†²çªè·¯ç”±
2. âœ… æ¸…ç† `.next` ç¼“å­˜
3. âœ… é‡å¯å¼€å‘æœåŠ¡å™¨

**å¦åˆ™å¯èƒ½è¿˜ä¼šæŠ¥é”™ï¼**

---

**é—®é¢˜å·²å®Œå…¨è§£å†³ï¼æ”¶è—åŠŸèƒ½ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼** ğŸ‰

